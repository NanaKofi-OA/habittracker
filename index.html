<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monthly Habit Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const Calendar = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>;
        const Plus = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const X = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const Edit2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>;
        const Save = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>;
        const ChevronLeft = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>;
        const ChevronRight = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>;

        const HabitTracker = () => {
          const [currentDate, setCurrentDate] = useState(new Date());
          const [habits, setHabits] = useState(null);
          const [newHabitName, setNewHabitName] = useState('');
          const [editingHabit, setEditingHabit] = useState(null);
          const [editName, setEditName] = useState('');

          const getDefaultHabits = () => [
            { id: 1, name: '30m Read', color: 'bg-red-200', completions: {} },
            { id: 2, name: 'Journal', color: 'bg-orange-200', completions: {} },
            { id: 3, name: '1h German', color: 'bg-yellow-200', completions: {} },
            { id: 4, name: 'Leetcode Problem', color: 'bg-green-200', completions: {} },
            { id: 5, name: '2h CS50', color: 'bg-blue-200', completions: {} },
            { id: 6, name: '15m Articulacy', color: 'bg-purple-200', completions: {} },
            { id: 7, name: '30m Bible', color: 'bg-pink-200', completions: {} },
            { id: 8, name: '30m Dayreview', color: 'bg-indigo-200', completions: {} }
          ];

          useEffect(() => {
            const loadData = () => {
              try {
                const saved = localStorage.getItem('habits');
                if (saved) {
                  setHabits(JSON.parse(saved));
                } else {
                  setHabits(getDefaultHabits());
                }
              } catch (error) {
                console.error('Error loading data:', error);
                setHabits(getDefaultHabits());
              }
            };
            loadData();
          }, []);

          const saveData = (updatedHabits) => {
            try {
              localStorage.setItem('habits', JSON.stringify(updatedHabits));
            } catch (error) {
              console.error('Error saving:', error);
            }
          };

          const getDaysInMonth = (date) => {
            const year = date.getFullYear();
            const month = date.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDay = new Date(year, month, 1).getDay();
            return { daysInMonth, firstDay, year, month };
          };

          const getWeeksInMonth = () => {
            const { daysInMonth, firstDay } = getDaysInMonth(currentDate);
            const weeks = [];
            let currentWeek = [];
            
            for (let i = 0; i < firstDay; i++) {
              currentWeek.push(null);
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
              currentWeek.push(day);
              if (currentWeek.length === 7) {
                weeks.push(currentWeek);
                currentWeek = [];
              }
            }
            
            if (currentWeek.length > 0) {
              while (currentWeek.length < 7) {
                currentWeek.push(null);
              }
              weeks.push(currentWeek);
            }
            
            return weeks;
          };

          const toggleHabit = (habitId, day) => {
            const updatedHabits = habits.map(habit => {
              if (habit.id === habitId) {
                const key = `${currentDate.getFullYear()}-${currentDate.getMonth()}-${day}`;
                const newCompletions = { ...habit.completions };
                newCompletions[key] = !newCompletions[key];
                return { ...habit, completions: newCompletions };
              }
              return habit;
            });
            setHabits(updatedHabits);
            saveData(updatedHabits);
          };

          const isHabitCompleted = (habit, day) => {
            if (!day) return false;
            const key = `${currentDate.getFullYear()}-${currentDate.getMonth()}-${day}`;
            return habit.completions[key] || false;
          };

          const calculateDailyCompletion = (day) => {
            if (!day) return 0;
            const completed = habits.filter(habit => isHabitCompleted(habit, day)).length;
            return Math.round((completed / habits.length) * 100);
          };

          const calculateTotalCompletion = () => {
            const { daysInMonth } = getDaysInMonth(currentDate);
            const today = new Date();
            const isCurrentMonth = today.getMonth() === currentDate.getMonth() && 
                                  today.getFullYear() === currentDate.getFullYear();
            const daysToCount = isCurrentMonth ? today.getDate() : daysInMonth;
            
            let totalPossible = habits.length * daysToCount;
            let totalCompleted = 0;
            
            for (let day = 1; day <= daysToCount; day++) {
              totalCompleted += habits.filter(habit => isHabitCompleted(habit, day)).length;
            }
            
            return Math.round((totalCompleted / totalPossible) * 100);
          };

          const addHabit = () => {
            if (newHabitName.trim()) {
              const colors = ['bg-red-200', 'bg-orange-200', 'bg-yellow-200', 'bg-green-200', 'bg-blue-200', 'bg-purple-200', 'bg-pink-200'];
              const newHabit = {
                id: Date.now(),
                name: newHabitName,
                color: colors[habits.length % colors.length],
                completions: {}
              };
              const updatedHabits = [...habits, newHabit];
              setHabits(updatedHabits);
              saveData(updatedHabits);
              setNewHabitName('');
            }
          };

          const deleteHabit = (habitId) => {
            const updatedHabits = habits.filter(h => h.id !== habitId);
            setHabits(updatedHabits);
            saveData(updatedHabits);
          };

          const startEditing = (habit) => {
            setEditingHabit(habit.id);
            setEditName(habit.name);
          };

          const saveEdit = (habitId) => {
            const updatedHabits = habits.map(h => 
              h.id === habitId ? { ...h, name: editName } : h
            );
            setHabits(updatedHabits);
            saveData(updatedHabits);
            setEditingHabit(null);
          };

          const changeMonth = (direction) => {
            const newDate = new Date(currentDate);
            newDate.setMonth(newDate.getMonth() + direction);
            setCurrentDate(newDate);
          };

          if (!habits) {
            return (
              <div className="min-h-screen bg-gray-50 flex items-center justify-center">
                <div className="text-gray-600">Loading...</div>
              </div>
            );
          }

          const weeks = getWeeksInMonth();
          const monthName = currentDate.toLocaleString('default', { month: 'long', year: 'numeric' });
          const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

          const getWeekColor = (weekIndex) => {
            const colors = ['bg-blue-500', 'bg-yellow-500', 'bg-yellow-300', 'bg-purple-500', 'bg-gray-300'];
            return colors[weekIndex] || 'bg-gray-300';
          };

          return (
            <div className="min-h-screen bg-gray-50 p-2 sm:p-4">
              <div className="max-w-7xl mx-auto">
                <div className="bg-gray-800 text-white p-3 sm:p-6 rounded-t-lg">
                  <div className="flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-0 mb-4">
                    <h1 className="text-lg sm:text-2xl font-bold flex items-center gap-2">
                      <Calendar />
                      MONTHLY HABITS
                    </h1>
                    <div className="flex items-center gap-2 sm:gap-4">
                      <button onClick={() => changeMonth(-1)} className="p-2 hover:bg-gray-700 rounded">
                        <ChevronLeft />
                      </button>
                      <span className="text-sm sm:text-lg font-medium min-w-[140px] sm:min-w-[180px] text-center">{monthName}</span>
                      <button onClick={() => changeMonth(1)} className="p-2 hover:bg-gray-700 rounded">
                        <ChevronRight />
                      </button>
                    </div>
                  </div>
                  
                  <div className="bg-gray-700 p-3 sm:p-4 rounded">
                    <h2 className="text-xs sm:text-sm font-semibold mb-3">SUMMARY</h2>
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm">
                      <div>
                        <div className="text-gray-400 mb-1">View from</div>
                        <div className="bg-white text-blue-600 px-2 sm:px-3 py-1 rounded text-center font-medium">
                          {currentDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                        </div>
                      </div>
                      <div>
                        <div className="text-gray-400 mb-1">Complete to date:</div>
                        <div className="bg-white text-gray-800 px-2 sm:px-3 py-1 rounded text-center font-bold">
                          {calculateTotalCompletion()}%
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-b-lg shadow-lg overflow-x-auto">
                  <div className="p-3 sm:p-6">
                    <h2 className="text-base sm:text-lg font-bold mb-4">MONTH VIEW</h2>
                    
                    <div className="min-w-[800px] sm:min-w-[1200px]">
                      <div className="grid gap-1 sm:gap-2 mb-2" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                        <div></div>
                        {weeks.map((week, weekIndex) => (
                          <div key={weekIndex} className={`${getWeekColor(weekIndex)} text-white text-center py-1 sm:py-2 rounded font-semibold text-xs sm:text-sm`}>
                            Week {weekIndex + 1}
                          </div>
                        ))}
                      </div>

                      <div className="grid gap-1 sm:gap-2 mb-3 sm:mb-4" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                        <div className="text-xs sm:text-sm font-semibold flex items-center">Daily %</div>
                        {weeks.map((week, weekIndex) => (
                          <div key={weekIndex} className="grid grid-cols-7 gap-0.5 sm:gap-1">
                            {week.map((day, dayIndex) => (
                              <div key={dayIndex} className={`${day ? getWeekColor(weekIndex) : 'bg-gray-100'} text-white text-center py-1 sm:py-2 rounded text-xs sm:text-sm font-bold`}>
                                {day ? `${calculateDailyCompletion(day)}%` : ''}
                              </div>
                            ))}
                          </div>
                        ))}
                      </div>

                      <div className="grid gap-1 sm:gap-2 mb-1 sm:mb-2" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                        <div className="text-xs sm:text-sm font-semibold">Daily habits</div>
                        {weeks.map((week, weekIndex) => (
                          <div key={weekIndex} className="grid grid-cols-7 gap-0.5 sm:gap-1">
                            {week.map((day, dayIndex) => (
                              <div key={dayIndex} className={`${day ? getWeekColor(weekIndex) : 'bg-gray-100'} text-white text-center py-0.5 sm:py-1 rounded-t text-xs font-semibold`}>
                                {day ? dayNames[dayIndex].slice(0, 1) : ''}
                              </div>
                            ))}
                          </div>
                        ))}
                      </div>

                      <div className="grid gap-1 sm:gap-2 mb-3 sm:mb-4" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                        <div></div>
                        {weeks.map((week, weekIndex) => (
                          <div key={weekIndex} className="grid grid-cols-7 gap-0.5 sm:gap-1">
                            {week.map((day, dayIndex) => (
                              <div key={dayIndex} className={`${day ? getWeekColor(weekIndex) : 'bg-gray-100'} text-white text-center py-0.5 sm:py-1 rounded-b text-xs sm:text-sm font-bold`}>
                                {day || ''}
                              </div>
                            ))}
                          </div>
                        ))}
                      </div>

                      {habits.map((habit) => (
                        <div key={habit.id} className="grid gap-1 sm:gap-2 mb-1 sm:mb-2" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                          <div className={`${habit.color} p-1.5 sm:p-2 rounded flex items-center justify-between group`}>
                            {editingHabit === habit.id ? (
                              <div className="flex items-center gap-1 sm:gap-2 flex-1">
                                <input
                                  type="text"
                                  value={editName}
                                  onChange={(e) => setEditName(e.target.value)}
                                  className="flex-1 px-1.5 sm:px-2 py-1 rounded border text-xs sm:text-sm"
                                  onKeyPress={(e) => e.key === 'Enter' && saveEdit(habit.id)}
                                />
                                <button onClick={() => saveEdit(habit.id)} className="p-0.5 sm:p-1 hover:bg-white/50 rounded">
                                  <div className="w-4 h-4 sm:w-6 sm:h-6"><Save /></div>
                                </button>
                              </div>
                            ) : (
                              <>
                                <span className="text-xs sm:text-sm font-medium truncate">{habit.name}</span>
                                <div className="opacity-100 sm:opacity-0 sm:group-hover:opacity-100 flex gap-0.5 sm:gap-1 transition-opacity">
                                  <button onClick={() => startEditing(habit)} className="p-0.5 sm:p-1 hover:bg-white/50 rounded">
                                    <div className="w-4 h-4 sm:w-6 sm:h-6"><Edit2 /></div>
                                  </button>
                                  <button onClick={() => deleteHabit(habit.id)} className="p-0.5 sm:p-1 hover:bg-white/50 rounded">
                                    <div className="w-4 h-4 sm:w-6 sm:h-6"><X /></div>
                                  </button>
                                </div>
                              </>
                            )}
                          </div>
                          {weeks.map((week, weekIndex) => (
                            <div key={weekIndex} className="grid grid-cols-7 gap-0.5 sm:gap-1">
                              {week.map((day, dayIndex) => (
                                <button
                                  key={dayIndex}
                                  onClick={() => day && toggleHabit(habit.id, day)}
                                  disabled={!day}
                                  className={`aspect-square border-2 rounded transition-all ${
                                    day
                                      ? isHabitCompleted(habit, day)
                                        ? 'border-blue-600 bg-blue-600'
                                        : 'border-blue-600 bg-white hover:bg-blue-50'
                                      : 'border-gray-200 bg-gray-50'
                                  }`}
                                >
                                  {day && isHabitCompleted(habit, day) && (
                                    <div className="text-white text-sm sm:text-xl leading-none">âœ“</div>
                                  )}
                                </button>
                              ))}
                            </div>
                          ))}
                        </div>
                      ))}

                      <div className="grid gap-1 sm:gap-2 mt-3 sm:mt-4" style={{ gridTemplateColumns: '120px repeat(5, 1fr)' }}>
                        <div className="flex gap-1 sm:gap-2">
                          <input
                            type="text"
                            value={newHabitName}
                            onChange={(e) => setNewHabitName(e.target.value)}
                            onKeyPress={(e) => e.key === 'Enter' && addHabit()}
                            placeholder="New habit..."
                            className="flex-1 px-2 sm:px-3 py-1.5 sm:py-2 border rounded text-xs sm:text-sm"
                          />
                          <button
                            onClick={addHabit}
                            className="bg-blue-600 text-white p-1.5 sm:p-2 rounded hover:bg-blue-700 transition-colors"
                          >
                            <Plus />
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<HabitTracker />, document.getElementById('root'));
    </script>
</body>
</html>
